hou1617
#View(hou1617)
g1 <- ggplot(data = hou1617, aes(x = reorder(name,-Homecount), y = Home17_perc, size = Homecount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with Home/Away", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = mlbHomefbbarrelrate*100)
g1
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g2 <- g1 + geom_point(aes(y=Away17_perc),colour='black')
#+ geom_text(aes(label=name), hjust = 1.2, vjust = 1)
g3 <- g2 + geom_segment(aes(x = "Alex Bregman", y = 14.89,
xend = "Alex Bregman", yend = 11.39),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3) +
geom_segment(aes(x = "Yuli Gurriel", y = 13.1,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 10.46,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 6.31,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 13.99,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 6.78,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 12.61,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 17.5,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1)+
geom_segment(aes(x = "Jake Marisnick", y = 4.29,
xend = "Jake Marisnick", yend = 7.81),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1)
g3 + theme_classic()
g11 <- ggplot(data = hou1617, aes(x = reorder(name,-Home16count), y = Home17_perc, size = Homecount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with 16/17 Home", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = mlbHomefbbarrelrate*100)
g11
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',size = hou1617$Home16count/28)
g12
g13 <- g12 + geom_segment(aes(x = "Yuli Gurriel", y = 16.22,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 18.63,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 7.59,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 15.85,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 10.53,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 7.44,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 6.49,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "George Springer", y = 5.59,
xend = "George Springer", yend = 10.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Marwin Gonzalez", y = 17.24,
xend = "Marwin Gonzalez", yend = 12.98),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)
g13 + theme_classic()
g11 <- ggplot(data = hou1617, aes(x = reorder(name,-Home16count), y = Home17_perc, size = Homecount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with 16/17 Home", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = Homebarrelrate2016*100)
g11
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',size = hou1617$Home16count/28)
g12
g13 <- g12 + geom_segment(aes(x = "Yuli Gurriel", y = 16.22,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 18.63,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 7.59,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 15.85,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 10.53,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 7.44,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 6.49,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "George Springer", y = 5.59,
xend = "George Springer", yend = 10.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Marwin Gonzalez", y = 17.24,
xend = "Marwin Gonzalez", yend = 12.98),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)
g13 + theme_classic()
# 선수별 직구타격 개수(홈)
Homecount16 <- lapply( split(Homefb16, Homefb16$player_name), nrow)
# 선수별 파워타구 개수(홈)
Homebarrelcount16 <- lapply( split(Homefbbarrel16, Homefbbarrel16$player_name), nrow)
class(Homecount16)
class(Homebarrelcount16)
View(Homecount16)
cbind(Homecount16, Homebarrelcount16)
result16 <- cbind(Homecount16, Homebarrelcount16)
result16
result16 <- subset(result16, Homecount16 > 10)
result16
result16$Homebarrelcount16 <- as.vector(result16$Homebarrelcount16)
result16$Homecount16 <- as.vector(result16$Homecount16)
View(result16)
as.data.frame(result16)
Homebarrelrate2016 <- read.csv("Homebarrelrate2016.csv")
Homebarrelrate2016$Homebarrelrate2016 <- as.vector(Homebarrelrate2016$Homebarrelrate2016)
Homebarrelrate2016
g11 <- ggplot(data = hou1617, aes(x = reorder(name,-Home16count), y = Home17_perc, size = Homecount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with 16/17 Home", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = 0.107007973*100)
g11
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',size = hou1617$Home16count/28)
g12
g13 <- g12 + geom_segment(aes(x = "Yuli Gurriel", y = 16.22,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 18.63,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 7.59,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 15.85,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 10.53,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 7.44,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 6.49,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "George Springer", y = 5.59,
xend = "George Springer", yend = 10.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Marwin Gonzalez", y = 17.24,
xend = "Marwin Gonzalez", yend = 12.98),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)
g13 + theme_classic()
#View(hou1617)
g1 <- ggplot(data = hou1617, aes(x = reorder(name,-Homecount), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with Home/Away", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = mlbHomefbbarrelrate*100)
g1
###Viz
hou1617 <- read.csv("Comparebarrelrate1617.csv")
hou1617
#View(hou1617)
g1 <- ggplot(data = hou1617, aes(x = reorder(name,-Homecount), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with Home/Away", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = mlbHomefbbarrelrate*100)
g1
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g2 <- g1 + geom_point(aes(y=Away17_perc),colour='black')
#+ geom_text(aes(label=name), hjust = 1.2, vjust = 1)
g3 <- g2 + geom_segment(aes(x = "Alex Bregman", y = 14.89,
xend = "Alex Bregman", yend = 11.39),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3) +
geom_segment(aes(x = "Yuli Gurriel", y = 13.1,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 10.46,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 6.31,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 13.99,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 6.78,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 12.61,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 17.5,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1)+
geom_segment(aes(x = "Jake Marisnick", y = 4.29,
xend = "Jake Marisnick", yend = 7.81),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1)
g3 + theme_classic()
#View(hou1617)
g1 <- ggplot(data = hou1617, aes(x = reorder(name,-Hitcount), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with Home/Away", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = mlbHomefbbarrelrate*100)
g1
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g2 <- g1 + geom_point(aes(y=Away17_perc),colour='black')
#+ geom_text(aes(label=name), hjust = 1.2, vjust = 1)
g3 <- g2 + geom_segment(aes(x = "Alex Bregman", y = 14.89,
xend = "Alex Bregman", yend = 11.39),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3) +
geom_segment(aes(x = "Yuli Gurriel", y = 13.1,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 10.46,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 6.31,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 13.99,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 6.78,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 12.61,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 17.5,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1)+
geom_segment(aes(x = "Jake Marisnick", y = 4.29,
xend = "Jake Marisnick", yend = 7.81),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1)
g3 + theme_classic()
g11 <- ggplot(data = hou1617, aes(x = reorder(name,-Home16count), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with 16/17 Home", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = 0.107007973*100)
g11
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',size = hou1617$Home16count/28)
g12
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black')
g12
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',,size = hou1617$Home16count/28)
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',size = hou1617$Home16count/28)
g12
g13 <- g12 + geom_segment(aes(x = "Yuli Gurriel", y = 16.22,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 18.63,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 7.59,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 15.85,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 10.53,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 7.44,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 6.49,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "George Springer", y = 5.59,
xend = "George Springer", yend = 10.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Marwin Gonzalez", y = 17.24,
xend = "Marwin Gonzalez", yend = 12.98),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)
g13 + theme_classic()
###Viz
hou1617 <- read.csv("Comparebarrelrate1617.csv")
hou1617
#View(hou1617)
g1 <- ggplot(data = hou1617, aes(x = reorder(name,-Hitcount), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with Home/Away", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = mlbHomefbbarrelrate*100)
g1
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g2 <- g1 + geom_point(aes(y=Away17_perc),colour='black')
#+ geom_text(aes(label=name), hjust = 1.2, vjust = 1)
g3 <- g2 + geom_segment(aes(x = "Alex Bregman", y = 14.89,
xend = "Alex Bregman", yend = 11.39),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3) +
geom_segment(aes(x = "Yuli Gurriel", y = 13.1,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 10.46,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 6.31,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 13.99,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 6.78,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 12.61,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 17.5,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1)+
geom_segment(aes(x = "Jake Marisnick", y = 4.29,
xend = "Jake Marisnick", yend = 7.81),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1)
g3 + theme_classic()
g11 <- ggplot(data = hou1617, aes(x = reorder(name,-Home16count), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with 16/17 Home", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = 0.107007973*100)
g11
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',size = hou1617$Home16count/28)
g12
g13 <- g12 + geom_segment(aes(x = "Yuli Gurriel", y = 16.22,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 18.63,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 7.59,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 15.85,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 10.53,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 7.44,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 6.49,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "George Springer", y = 5.59,
xend = "George Springer", yend = 10.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Marwin Gonzalez", y = 17.24,
xend = "Marwin Gonzalez", yend = 12.98),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)
g13 + theme_classic()
setwd('D:\\workspace\\Rproject\\termproject')
##2017년 휴스턴 투구별 타자기록 불러오기
data <- read.csv("HOU17_pitch.csv")
str(data)
#+ geom_text(aes(label=name), hjust = 1.2, vjust = 1)
g3 <- g2 + geom_segment(aes(x = "Alex Bregman", y = 14.89,
xend = "Alex Bregman", yend = 11.39),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3) +
geom_segment(aes(x = "Yuli Gurriel", y = 13.1,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 10.46,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 6.31,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 13.99,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 6.78,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 12.61,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 17.5,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1)+
geom_segment(aes(x = "Jake Marisnick", y = 4.29,
xend = "Jake Marisnick", yend = 7.81),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1)
library(data.table)
library(dplyr)
library(ggplot2)
library(plyr)
library(RColorBrewer)
library(scales)
library(ggthemes)
setwd('D:\\workspace\\Rproject\\termproject')
##2017년 휴스턴 투구별 타자기록 불러오기
data <- read.csv("HOU17_pitch.csv")
###Viz
hou1617 <- read.csv("Comparebarrelrate1617.csv")
#View(hou1617)
g1 <- ggplot(data = hou1617, aes(x = reorder(name,-Hitcount), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with Home/Away", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = mlbHomefbbarrelrate*100)
g1
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g2 <- g1 + geom_point(aes(y=Away17_perc),colour='black')
#+ geom_text(aes(label=name), hjust = 1.2, vjust = 1)
g3 <- g2 + geom_segment(aes(x = "Alex Bregman", y = 14.89,
xend = "Alex Bregman", yend = 11.39),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3) +
geom_segment(aes(x = "Yuli Gurriel", y = 13.1,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 10.46,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 6.31,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 13.99,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 6.78,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 12.61,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 17.5,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1)+
geom_segment(aes(x = "Jake Marisnick", y = 4.29,
xend = "Jake Marisnick", yend = 7.81),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1)
g3 + theme_classic()
g11 <- ggplot(data = hou1617, aes(x = reorder(name,-Home16count), y = Home17_perc, size = Hitcount)) +
geom_point(colour='red') +
geom_text(aes(label = Home17_perc),hjust = 0, vjust = -1, show_guide=F,  check_overlap=TRUE) +
labs(title = "HOU17 BarrelHit rate", subtitle="Compare with 16/17 Home", caption = "refer to Baseballsavant.mlb.com", x = "선수이름", y="BarrelHit %") +
geom_hline(yintercept = 0.107007973*100)
g11
#geom_line(aes(y=mlbHomefbbarrelrate*100), color="blue", linetype=1)
g12 <- g11 + geom_point(aes(y=Home16_perc),colour='black',size = hou1617$Home16count/28)
g12
g13 <- g12 + geom_segment(aes(x = "Yuli Gurriel", y = 16.22,
xend = "Yuli Gurriel", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Jose Altuve", y = 18.63,
xend = "Jose Altuve", yend = 11.11),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Beltran", y = 7.59,
xend = "Carlos Beltran", yend = 13.85),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Josh Reddick", y = 15.85,
xend = "Josh Reddick", yend = 11.02),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)+
geom_segment(aes(x = "Carlos Correa", y = 10.53,
xend = "Carlos Correa", yend = 12.04),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Brian McCann", y = 7.44,
xend = "Brian McCann", yend = 16.28),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Evan Gattis", y = 6.49,
xend = "Evan Gattis", yend = 14.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "George Springer", y = 5.59,
xend = "George Springer", yend = 10.29),
arrow=arrow(length=unit(0.4,'cm')), color='red',size=1.3)+
geom_segment(aes(x = "Marwin Gonzalez", y = 17.24,
xend = "Marwin Gonzalez", yend = 12.98),
arrow=arrow(length=unit(0.4,'cm')), color='blue',size=1.3)
g13 + theme_classic()
opar <- par(mfrow=c(1,2))
g3 + theme_classic()
g13 + theme_classic()
par(opar)
opar <- par(mfrow=c(1,2))
g3 + theme_classic()
g13 + theme_classic()
par(opar)
opar <- par(mfrow=c(1,2))
opar
g3 + theme_classic()
g13 + theme_classic()
par(opar)
g3 + theme_classic()
g13 + theme_classic()
